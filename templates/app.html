{% extends "base.html" %}

{% block content %}
<div class="container">
    <!-- Header -->
    <div class="hero">
        <h1 class="hero-title">Miya Skaneri Tahlili</h1>
        <p class="hero-subtitle">
            MRI yoki CT skaneringizni yuklang va sun'iy intellekt yordamida 
            miya o'simtalarini tezda aniqlang
        </p>
    </div>

    <!-- Main Grid -->
    <div class="grid-2">
        <!-- Upload Section -->
        <div class="card">
            <div class="card-header">
                <div class="card-icon">📤</div>
                <div>
                    <div class="card-title">Rasm Yuklash</div>
                    <div class="card-subtitle">MRI yoki CT skaneringizni yuklang</div>
                </div>
            </div>

            <div class="upload-area" onclick="document.getElementById('imageInput').click()">
                <div class="upload-icon">📁</div>
                <h3 style="margin-bottom: 0.5rem; color: var(--text-primary);">Faylni Tanlang</h3>
                <p style="color: var(--text-muted);">PNG, JPG, JPEG formatida (Maks. 10MB)</p>
                <input type="file" id="imageInput" accept="image/*" style="display: none;">
            </div>
            
            <button id="guideBtn" class="btn btn-secondary w-100 mt-4" onclick="showGuide()">
                📖 Foydalanish Qo'llanmasi
            </button>

            <button id="analyzeBtn" class="btn btn-primary w-100 mt-3 hidden" onclick="analyzeImage()">
                🧠 AI Tahlil Boshlash
            </button>
        </div>

        <!-- Results Section -->
        <div class="card">
            <div id="emptyState">
                <div class="text-center" style="padding: 3rem 2rem;">
                    <div style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.7;">🧠</div>
                    <h3 style="color: var(--text-secondary); margin-bottom: 0.5rem;">Tahlil Natijasi</h3>
                    <p style="color: var(--text-muted);">Yuklangan rasm tahlili bu yerda ko'rsatiladi</p>
                </div>
            </div>

            <div id="previewState" class="hidden">
                <div class="card-header">
                    <div class="card-icon">✨</div>
                    <div>
                        <div class="card-title">Yuklangan Rasm</div>
                        <div class="card-subtitle">Tahlil qilish uchun tasdiqlang</div>
                    </div>
                </div>
                <div class="text-center">
                    <img id="imagePreview" alt="Yuklangan rasm" 
                         style="max-width: 100%; max-height: 300px; border-radius: 12px; border: 2px solid var(--border);">
                </div>
            </div>

            <div id="loadingState" class="hidden">
                <div class="loading">
                    <div class="spinner"></div>
                    <h3 style="color: var(--text-primary); margin-bottom: 0.5rem;">AI Tahlil Jarayoni</h3>
                    <p style="color: var(--text-muted);">Rasm qayta ishlanmoqda, iltimos kuting...</p>
                </div>
            </div>

            <div id="resultState" class="hidden"></div>
        </div>
    </div>
</div>

<!-- Guide Modal -->
<div id="guideModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="hideGuide()">&times;</span>
        <h2>Foydalanish Qo'llanmasi</h2>
        <div class="info-grid">
            <div class="info-item">
                <h3>📤 1. Rasm Yuklash</h3>
                <p>MRI yoki CT skan rasmini yuklang (PNG, JPG, JPEG formatida)</p>
            </div>
            <div class="info-item">
                <h3>🔍 2. Tahlil Boshlash</h3>
                <p>"AI Tahlil Boshlash" tugmasini bosing</p>
            </div>
            <div class="info-item">
                <h3>⏳ 3. Natijani Kutish</h3>
                <p>Bir necha soniya ichida natija ko'rsatiladi</p>
            </div>
            <div class="info-item">
                <h3>📊 4. Natijani Ko'rish</h3>
                <p>Aniqlangan o'simtalar va ularning joylashuvi</p>
            </div>
        </div>
        <div class="medical-note">
            <strong>❗ Diqqat:</strong> Bu dastlabki tahlil. Aniq natija uchun mutaxassis shifokorga murojaat qiling.
        </div>
    </div>
</div>
{% endblock %}